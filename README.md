# MovieRecSys

Тестовое задания для VK. Нужно было создать embeddings для пользовтпеля и фильма. При этом чтобы можно было по пользователю рекмоендовать фильм. 

Данные для обучения:


*  **Фильмы.** Я взял все теги для фильма и плюс добавил его рейтинг. Название фильма, год и жанры я в итоговой реализации проигнорировал, хотя последние два признака я думаю помогут сильно повысить качество в итоге.
*  **Пользователь.** Я взял все теги пользователя и фильмы 50 самых популярных тегов которые ему понравились.


Получается что в каждом случае это строка состоящая из тегов. Я ограничился их количество до 128.


Далее получил для каждого тега его input_id из предобученного токенайзера от Bert.


**Разделение на train и test**
Я поступил достаточно просто и для обучения и тестирования взял 12 тысяч наблюдений. 80% я отдал на обучение. Я ограничился train и val выборкой поскольку времени слишком мало на адекватное тестирование, также как и на масштабную тренировку. При этом при разделении я взял 6 тысяч наблюдений где рейтинг ниже 2.5 и 6 где больше. Баланс классов сильно поможет при обучении в моем подходе.


**Модель**
Взял конечно же предобученный трансформер - классический Bert. А точнее из него я беру эмбеддинг для слов из скрытого состояния. А затем получившийся embedding для человека и фильма я прогоняю в линейный слой, по сути это проекция на меньший масштаб, в моем случае вектор на 512 значений.


**Метрика**
В качестве метрики я использовал cosine similarity. В моем случае если человек поставил фильму оценку меньше 2.5 то фильм плохой и не понравился ему. Значит расстояние между таким человеком и вектором фильма должно быть меньше. В противном случае он отнесся нейтрально к фильму или он ему понравился - тогда их близость должна расти. В качестве loss функции была Cosine Embedding Loss. Также косинусное расстояние. Косинусное расстояние является хорошим выбором для данной задачи рекомендации фильмов по тегам, так как оно является метрикой сходства между векторами, которая не зависит от их длины и может быть использована для сравнения векторов разной размерности. С точки зрения представления пользователь и фильмы, понравившиеся ему должны быть напралвены в одном направлении, а задизлайканные удаляться в ином направлении, в сторону. 
